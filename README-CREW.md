# AI 크루 팀 구축 플랫폼

AI 에이전트(크루)를 구성하고 슬랙 스타일의 채팅 인터페이스를 통해 소통하며, 대화 히스토리를 저장하고 최적화하는 플랫폼입니다.

## 주요 기능

### 1. 크루 관리
- 크루(에이전트) 추가, 수정, 삭제
- 각 크루의 이름, 역할, 지침(프롬프트) 설정
- 노션 스타일의 아바타 자동 생성
- 어벤저스 스타일의 그리드 레이아웃

### 2. 1:1 채팅
- 슬랙 스타일의 채팅 인터페이스
- GPT-4o 스트리밍 응답
- 대화 히스토리 자동 저장
- 채팅 중 지침 최적화 기능

### 3. 그룹 채팅
- 여러 크루가 참여하는 멀티 에이전트 대화
- 쓰레드 기반 대화 시스템
- 크루들이 마스터에게 액션 힌트 제공

### 4. 내보내기
- 노션 API로 문서 생성
- 슬랙 API로 메시지 전송
- 마크다운 복사

## 시작하기

### 1. 환경 변수 설정

`.env` 파일을 생성하고 다음 변수들을 설정하세요:

```env
DATABASE_URL="postgresql://user:password@localhost:5432/dbname"
OPENAI_API_KEY="sk-..."
NOTION_API_KEY="secret_..." # 선택사항
SLACK_BOT_TOKEN="xoxb-..." # 선택사항
SLACK_CHANNEL_ID="C1234567890" # 선택사항
```

### 2. 데이터베이스 마이그레이션

```bash
npm run db:push
# 또는
npm run db:migrate
```

### 3. 개발 서버 실행

```bash
npm run dev
```

브라우저에서 `http://localhost:3000`을 열면 크루 관리 페이지가 표시됩니다.

## 사용 방법

### 크루 추가하기

1. 메인 페이지에서 "+ 크루 추가" 버튼 클릭
2. 크루의 이름, 역할, 지침(프롬프트) 입력
3. 저장하면 자동으로 아바타가 생성됩니다

예시:
- 이름: 도파민 카피라이터 Geun
- 역할: SNS용 후킹 카피와 USP를 발굴하는 실전 카피라이터
- 지침: [상세한 프롬프트 작성]

### 1:1 채팅하기

1. 크루 카드를 클릭하여 채팅 페이지로 이동
2. 메시지를 입력하고 Enter로 전송
3. 크루의 응답이 실시간으로 스트리밍됩니다
4. 크루의 응답에 마우스를 올리면 "지침에 추가" 버튼이 나타납니다

### 그룹 채팅하기

1. 메인 페이지에서 "그룹 채팅" 버튼 클릭
2. 그룹에 포함할 크루 선택 (최소 2명)
3. 그룹 채팅 페이지에서 여러 크루와 동시에 대화

### 내보내기

1. 채팅 페이지에서 "내보내기" 버튼 클릭
2. 노션 또는 슬랙으로 내보내기 선택
3. API 키 입력 후 내보내기 실행

## 기술 스택

- **프레임워크**: Next.js 14 (App Router)
- **언어**: TypeScript
- **스타일링**: Tailwind CSS
- **데이터베이스**: PostgreSQL + Prisma
- **AI**: OpenAI GPT-4o
- **외부 API**: 노션 API, 슬랙 API

## 프로젝트 구조

```
/
├── app/
│   ├── crew/              # 크루 관리 페이지
│   ├── chat/              # 채팅 페이지
│   │   ├── [crewId]/      # 1:1 채팅
│   │   └── group/         # 그룹 채팅
│   └── api/               # API 엔드포인트
├── components/
│   ├── crew/              # 크루 관련 컴포넌트
│   ├── chat/              # 채팅 관련 컴포넌트
│   └── export/            # 내보내기 컴포넌트
├── lib/
│   ├── crew-openai.ts     # GPT-4o 통합
│   ├── notion.ts          # 노션 API 클라이언트
│   ├── slack.ts           # 슬랙 API 클라이언트
│   └── avatar.ts          # 아바타 생성
└── prisma/
    └── schema.prisma      # 데이터베이스 스키마
```

## 주의사항

- 현재는 로컬 스토리지 기반으로 동작합니다 (인증 없음)
- 노션/슬랙 API 키는 사용자가 직접 입력해야 합니다
- 데이터베이스 마이그레이션을 실행해야 합니다

## 문제 해결

### Prisma 클라이언트 오류
```bash
npx prisma generate
```

### 데이터베이스 연결 오류
`.env` 파일의 `DATABASE_URL`을 확인하세요.

### OpenAI API 오류
`OPENAI_API_KEY`가 올바르게 설정되었는지 확인하세요.